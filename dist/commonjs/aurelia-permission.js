"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var aurelia_router_1 = require("aurelia-router");
var permission_store_1 = require("./permission-store");
exports.PermissionStore = permission_store_1.default;
var authorize_route_step_1 = require("./authorize-route-step");
var authorize_service_1 = require("./authorize-service");
exports.AuthorizeService = authorize_service_1.default;
function configure(framework, configure) {
    var permissionStore = framework.container.get(permission_store_1.default);
    var authorizeRouteStep = framework.container.get(authorize_route_step_1.default);
    configure(permissionStore, {
        useDefaultRedirectRoute: function (route) {
            authorizeRouteStep.useDefaultRedirectRoute(route);
        }
    });
    var appRouter = framework.container.get(aurelia_router_1.AppRouter);
    var authorizePipelineStep = appRouter.pipelineProvider.steps.find(function (step) { return step.slotName === 'preActivate'; });
    authorizePipelineStep.steps.push(authorize_route_step_1.default);
    framework.globalResources('./permission');
}
exports.configure = configure;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hdXJlbGlhLXBlcm1pc3Npb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxpREFBMkM7QUFFM0MsdURBQWlEO0FBOEIvQywwQkE5QkssMEJBQWUsQ0E4Qkw7QUE3QmpCLCtEQUF3RDtBQUN4RCx5REFBbUQ7QUE2QmpELDJCQTdCSywyQkFBZ0IsQ0E2Qkw7QUF2QmxCLG1CQUNFLFNBQWlDLEVBQ2pDLFNBQW1GO0lBRW5GLElBQU0sZUFBZSxHQUFvQixTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQywwQkFBZSxDQUFDLENBQUM7SUFDbEYsSUFBTSxrQkFBa0IsR0FBdUIsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsOEJBQWtCLENBQUMsQ0FBQztJQUUzRixTQUFTLENBQUMsZUFBZSxFQUFFO1FBQ3pCLHVCQUF1QixFQUFFLFVBQUMsS0FBYTtZQUNyQyxrQkFBa0IsQ0FBQyx1QkFBdUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRCxDQUFDO0tBQ0YsQ0FBQyxDQUFDO0lBR0gsSUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsMEJBQVMsQ0FBQyxDQUFDO0lBQ3JELElBQU0scUJBQXFCLEdBQUcsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBQSxJQUFJLElBQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekgscUJBQXFCLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyw4QkFBa0IsQ0FBQyxDQUFDO0lBRXJELFNBQVMsQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDNUMsQ0FBQztBQW5CRCw4QkFtQkMiLCJmaWxlIjoiYXVyZWxpYS1wZXJtaXNzaW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRnJhbWV3b3JrQ29uZmlndXJhdGlvbiB9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcclxuaW1wb3J0IHsgQXBwUm91dGVyIH0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xyXG5cclxuaW1wb3J0IFBlcm1pc3Npb25TdG9yZSBmcm9tICcuL3Blcm1pc3Npb24tc3RvcmUnO1xyXG5pbXBvcnQgQXV0aG9yaXplUm91dGVTdGVwIGZyb20gJy4vYXV0aG9yaXplLXJvdXRlLXN0ZXAnO1xyXG5pbXBvcnQgQXV0aG9yaXplU2VydmljZSBmcm9tICcuL2F1dGhvcml6ZS1zZXJ2aWNlJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlndXJhdGlvbiB7XHJcbiAgdXNlRGVmYXVsdFJlZGlyZWN0Um91dGU6IChyb3V0ZTogc3RyaW5nKSA9PiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29uZmlndXJlKFxyXG4gIGZyYW1ld29yazogRnJhbWV3b3JrQ29uZmlndXJhdGlvbixcclxuICBjb25maWd1cmU6IChwZXJtaXNzaW9uU3RvcmU6IFBlcm1pc3Npb25TdG9yZSwgY29uZmlndXJhdGlvbjogQ29uZmlndXJhdGlvbikgPT4gdm9pZFxyXG4pIHtcclxuICBjb25zdCBwZXJtaXNzaW9uU3RvcmUgPSA8UGVybWlzc2lvblN0b3JlPmZyYW1ld29yay5jb250YWluZXIuZ2V0KFBlcm1pc3Npb25TdG9yZSk7XHJcbiAgY29uc3QgYXV0aG9yaXplUm91dGVTdGVwID0gPEF1dGhvcml6ZVJvdXRlU3RlcD5mcmFtZXdvcmsuY29udGFpbmVyLmdldChBdXRob3JpemVSb3V0ZVN0ZXApO1xyXG5cclxuICBjb25maWd1cmUocGVybWlzc2lvblN0b3JlLCB7XHJcbiAgICB1c2VEZWZhdWx0UmVkaXJlY3RSb3V0ZTogKHJvdXRlOiBzdHJpbmcpID0+IHtcclxuICAgICAgYXV0aG9yaXplUm91dGVTdGVwLnVzZURlZmF1bHRSZWRpcmVjdFJvdXRlKHJvdXRlKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gQ29uZmlndXJlIHBpcGVsaW5lIHN0ZXAgZm9yIGF1dGhvcml6YXRpb24gYmVmb3JlIGFjdGl2YXRlIGlzIGludm9rZWRcclxuICBjb25zdCBhcHBSb3V0ZXIgPSBmcmFtZXdvcmsuY29udGFpbmVyLmdldChBcHBSb3V0ZXIpO1xyXG4gIGNvbnN0IGF1dGhvcml6ZVBpcGVsaW5lU3RlcCA9IGFwcFJvdXRlci5waXBlbGluZVByb3ZpZGVyLnN0ZXBzLmZpbmQoc3RlcCA9PiB7IHJldHVybiBzdGVwLnNsb3ROYW1lID09PSAncHJlQWN0aXZhdGUnOyB9KTtcclxuICBhdXRob3JpemVQaXBlbGluZVN0ZXAuc3RlcHMucHVzaChBdXRob3JpemVSb3V0ZVN0ZXApO1xyXG5cclxuICBmcmFtZXdvcmsuZ2xvYmFsUmVzb3VyY2VzKCcuL3Blcm1pc3Npb24nKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBQZXJtaXNzaW9uU3RvcmUsXHJcbiAgQXV0aG9yaXplU2VydmljZVxyXG59XHJcbiJdfQ==
