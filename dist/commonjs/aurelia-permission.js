"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var aurelia_router_1 = require("aurelia-router");
var permission_store_1 = require("./permission-store");
exports.PermissionsStore = permission_store_1.default;
var authorize_route_step_1 = require("./authorize-route-step");
var authorize_service_1 = require("./authorize-service");
exports.AuthorizeService = authorize_service_1.default;
function configure(framework, configure) {
    var permissionsStore = framework.container.get(permission_store_1.default);
    var authorizeRouteStep = framework.container.get(authorize_route_step_1.default);
    configure(permissionsStore, {
        setDefaultRedirectRoute: function (route) {
            authorizeRouteStep.setDefaultRedirectRoute(route);
        }
    });
    var appRouter = framework.container.get(aurelia_router_1.AppRouter);
    var authorizePipelineStep = appRouter.pipelineProvider.steps.find(function (step) { return step.slotName === 'preActivate'; });
    authorizePipelineStep.steps.push(authorize_route_step_1.default);
    framework.globalResources('./permission');
}
exports.configure = configure;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hdXJlbGlhLXBlcm1pc3Npb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxpREFBMkM7QUFFM0MsdURBQWtEO0FBOEJoRCwyQkE5QkssMEJBQWdCLENBOEJMO0FBN0JsQiwrREFBd0Q7QUFDeEQseURBQW1EO0FBNkJqRCwyQkE3QkssMkJBQWdCLENBNkJMO0FBdkJsQixtQkFDRSxTQUFpQyxFQUNqQyxTQUFxRjtJQUVyRixJQUFNLGdCQUFnQixHQUFxQixTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQywwQkFBZ0IsQ0FBQyxDQUFDO0lBQ3JGLElBQU0sa0JBQWtCLEdBQXVCLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLDhCQUFrQixDQUFDLENBQUM7SUFFM0YsU0FBUyxDQUFDLGdCQUFnQixFQUFFO1FBQzFCLHVCQUF1QixFQUFFLFVBQUMsS0FBYTtZQUNyQyxrQkFBa0IsQ0FBQyx1QkFBdUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRCxDQUFDO0tBQ0YsQ0FBQyxDQUFDO0lBR0gsSUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsMEJBQVMsQ0FBQyxDQUFDO0lBQ3JELElBQU0scUJBQXFCLEdBQUcsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBQSxJQUFJLElBQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekgscUJBQXFCLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyw4QkFBa0IsQ0FBQyxDQUFDO0lBRXJELFNBQVMsQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDNUMsQ0FBQztBQW5CRCw4QkFtQkMiLCJmaWxlIjoiYXVyZWxpYS1wZXJtaXNzaW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRnJhbWV3b3JrQ29uZmlndXJhdGlvbiB9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcclxuaW1wb3J0IHsgQXBwUm91dGVyIH0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xyXG5cclxuaW1wb3J0IFBlcm1pc3Npb25zU3RvcmUgZnJvbSAnLi9wZXJtaXNzaW9uLXN0b3JlJztcclxuaW1wb3J0IEF1dGhvcml6ZVJvdXRlU3RlcCBmcm9tICcuL2F1dGhvcml6ZS1yb3V0ZS1zdGVwJztcclxuaW1wb3J0IEF1dGhvcml6ZVNlcnZpY2UgZnJvbSAnLi9hdXRob3JpemUtc2VydmljZSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ3VyYXRpb24ge1xyXG4gIHNldERlZmF1bHRSZWRpcmVjdFJvdXRlOiAocm91dGU6IHN0cmluZykgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ3VyZShcclxuICBmcmFtZXdvcms6IEZyYW1ld29ya0NvbmZpZ3VyYXRpb24sXHJcbiAgY29uZmlndXJlOiAocGVybWlzc2lvbnNTdG9yZTogUGVybWlzc2lvbnNTdG9yZSwgY29uZmlndXJhdGlvbjogQ29uZmlndXJhdGlvbikgPT4gdm9pZFxyXG4pIHtcclxuICBjb25zdCBwZXJtaXNzaW9uc1N0b3JlID0gPFBlcm1pc3Npb25zU3RvcmU+ZnJhbWV3b3JrLmNvbnRhaW5lci5nZXQoUGVybWlzc2lvbnNTdG9yZSk7XHJcbiAgY29uc3QgYXV0aG9yaXplUm91dGVTdGVwID0gPEF1dGhvcml6ZVJvdXRlU3RlcD5mcmFtZXdvcmsuY29udGFpbmVyLmdldChBdXRob3JpemVSb3V0ZVN0ZXApO1xyXG5cclxuICBjb25maWd1cmUocGVybWlzc2lvbnNTdG9yZSwge1xyXG4gICAgc2V0RGVmYXVsdFJlZGlyZWN0Um91dGU6IChyb3V0ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGF1dGhvcml6ZVJvdXRlU3RlcC5zZXREZWZhdWx0UmVkaXJlY3RSb3V0ZShyb3V0ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIENvbmZpZ3VyZSBwaXBlbGluZSBzdGVwIGZvciBhdXRob3JpemF0aW9uIGJlZm9yZSBhY3RpdmF0ZSBpcyBpbnZva2VkXHJcbiAgY29uc3QgYXBwUm91dGVyID0gZnJhbWV3b3JrLmNvbnRhaW5lci5nZXQoQXBwUm91dGVyKTtcclxuICBjb25zdCBhdXRob3JpemVQaXBlbGluZVN0ZXAgPSBhcHBSb3V0ZXIucGlwZWxpbmVQcm92aWRlci5zdGVwcy5maW5kKHN0ZXAgPT4geyByZXR1cm4gc3RlcC5zbG90TmFtZSA9PT0gJ3ByZUFjdGl2YXRlJzsgfSk7XHJcbiAgYXV0aG9yaXplUGlwZWxpbmVTdGVwLnN0ZXBzLnB1c2goQXV0aG9yaXplUm91dGVTdGVwKTtcclxuXHJcbiAgZnJhbWV3b3JrLmdsb2JhbFJlc291cmNlcygnLi9wZXJtaXNzaW9uJyk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgUGVybWlzc2lvbnNTdG9yZSxcclxuICBBdXRob3JpemVTZXJ2aWNlXHJcbn1cclxuIl19
