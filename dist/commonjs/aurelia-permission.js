"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var aurelia_router_1 = require("aurelia-router");
var permission_store_1 = require("./permission-store");
exports.PermissionStore = permission_store_1.default;
var authorize_route_step_1 = require("./authorize-route-step");
var authorization_service_1 = require("./authorization-service");
exports.AuthorizationService = authorization_service_1.default;
function configure(framework, configure) {
    var permissionStore = framework.container.get(permission_store_1.default);
    var authorizeRouteStep = framework.container.get(authorize_route_step_1.default);
    configure(permissionStore, {
        useDefaultRedirectRoute: function (route) {
            authorizeRouteStep.useDefaultRedirectRoute(route);
        }
    });
    var appRouter = framework.container.get(aurelia_router_1.AppRouter);
    var authorizePipelineStep = appRouter.pipelineProvider.steps.find(function (step) { return step.slotName === 'preActivate'; });
    authorizePipelineStep.steps.push(authorize_route_step_1.default);
    framework.globalResources([
        './permission',
        './permission-filter'
    ]);
}
exports.configure = configure;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hdXJlbGlhLXBlcm1pc3Npb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxpREFBMkM7QUFFM0MsdURBQWlEO0FBaUMvQywwQkFqQ0ssMEJBQWUsQ0FpQ0w7QUFoQ2pCLCtEQUF3RDtBQUN4RCxpRUFBMkQ7QUFnQ3pELCtCQWhDSywrQkFBb0IsQ0FnQ0w7QUExQnRCLG1CQUNFLFNBQWlDLEVBQ2pDLFNBQW1GO0lBRW5GLElBQU0sZUFBZSxHQUFvQixTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQywwQkFBZSxDQUFDLENBQUM7SUFDbEYsSUFBTSxrQkFBa0IsR0FBdUIsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsOEJBQWtCLENBQUMsQ0FBQztJQUUzRixTQUFTLENBQUMsZUFBZSxFQUFFO1FBQ3pCLHVCQUF1QixFQUFFLFVBQUMsS0FBYTtZQUNyQyxrQkFBa0IsQ0FBQyx1QkFBdUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRCxDQUFDO0tBQ0YsQ0FBQyxDQUFDO0lBR0gsSUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsMEJBQVMsQ0FBQyxDQUFDO0lBQ3JELElBQU0scUJBQXFCLEdBQUcsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBQSxJQUFJLElBQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekgscUJBQXFCLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyw4QkFBa0IsQ0FBQyxDQUFDO0lBRXJELFNBQVMsQ0FBQyxlQUFlLENBQUM7UUFDeEIsY0FBYztRQUNkLHFCQUFxQjtLQUN0QixDQUFDLENBQUM7QUFDTCxDQUFDO0FBdEJELDhCQXNCQyIsImZpbGUiOiJhdXJlbGlhLXBlcm1pc3Npb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGcmFtZXdvcmtDb25maWd1cmF0aW9uIH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xyXG5pbXBvcnQgeyBBcHBSb3V0ZXIgfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XHJcblxyXG5pbXBvcnQgUGVybWlzc2lvblN0b3JlIGZyb20gJy4vcGVybWlzc2lvbi1zdG9yZSc7XHJcbmltcG9ydCBBdXRob3JpemVSb3V0ZVN0ZXAgZnJvbSAnLi9hdXRob3JpemUtcm91dGUtc3RlcCc7XHJcbmltcG9ydCBBdXRob3JpemF0aW9uU2VydmljZSBmcm9tICcuL2F1dGhvcml6YXRpb24tc2VydmljZSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ3VyYXRpb24ge1xyXG4gIHVzZURlZmF1bHRSZWRpcmVjdFJvdXRlOiAocm91dGU6IHN0cmluZykgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ3VyZShcclxuICBmcmFtZXdvcms6IEZyYW1ld29ya0NvbmZpZ3VyYXRpb24sXHJcbiAgY29uZmlndXJlOiAocGVybWlzc2lvblN0b3JlOiBQZXJtaXNzaW9uU3RvcmUsIGNvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRpb24pID0+IHZvaWRcclxuKSB7XHJcbiAgY29uc3QgcGVybWlzc2lvblN0b3JlID0gPFBlcm1pc3Npb25TdG9yZT5mcmFtZXdvcmsuY29udGFpbmVyLmdldChQZXJtaXNzaW9uU3RvcmUpO1xyXG4gIGNvbnN0IGF1dGhvcml6ZVJvdXRlU3RlcCA9IDxBdXRob3JpemVSb3V0ZVN0ZXA+ZnJhbWV3b3JrLmNvbnRhaW5lci5nZXQoQXV0aG9yaXplUm91dGVTdGVwKTtcclxuXHJcbiAgY29uZmlndXJlKHBlcm1pc3Npb25TdG9yZSwge1xyXG4gICAgdXNlRGVmYXVsdFJlZGlyZWN0Um91dGU6IChyb3V0ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGF1dGhvcml6ZVJvdXRlU3RlcC51c2VEZWZhdWx0UmVkaXJlY3RSb3V0ZShyb3V0ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIENvbmZpZ3VyZSBwaXBlbGluZSBzdGVwIGZvciBhdXRob3JpemF0aW9uIGJlZm9yZSBhY3RpdmF0ZSBpcyBpbnZva2VkXHJcbiAgY29uc3QgYXBwUm91dGVyID0gZnJhbWV3b3JrLmNvbnRhaW5lci5nZXQoQXBwUm91dGVyKTtcclxuICBjb25zdCBhdXRob3JpemVQaXBlbGluZVN0ZXAgPSBhcHBSb3V0ZXIucGlwZWxpbmVQcm92aWRlci5zdGVwcy5maW5kKHN0ZXAgPT4geyByZXR1cm4gc3RlcC5zbG90TmFtZSA9PT0gJ3ByZUFjdGl2YXRlJzsgfSk7XHJcbiAgYXV0aG9yaXplUGlwZWxpbmVTdGVwLnN0ZXBzLnB1c2goQXV0aG9yaXplUm91dGVTdGVwKTtcclxuXHJcbiAgZnJhbWV3b3JrLmdsb2JhbFJlc291cmNlcyhbXHJcbiAgICAnLi9wZXJtaXNzaW9uJyxcclxuICAgICcuL3Blcm1pc3Npb24tZmlsdGVyJ1xyXG4gIF0pO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIFBlcm1pc3Npb25TdG9yZSxcclxuICBBdXRob3JpemF0aW9uU2VydmljZVxyXG59XHJcbiJdfQ==
